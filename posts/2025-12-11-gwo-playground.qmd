---
title: "Interactive Grey Wolf Optimization"
author: "Ritwik Raha"
date: "2025-12-12"
format:
  html:
    toc: false
    page-layout: article
---

This is an interactive simulation of the Grey Wolf Optimizer (GWO) algorithm attempting to solve the **Rastrigin Function**. The global optimum is at the center `(0,0)`.

```{=html}
<style>
  .gwo-container {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 20px;
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #e9ecef;
  }
  .gwo-controls {
    flex: 1;
    min-width: 280px;
  }
  .gwo-canvas {
    flex: 0 0 auto;
    width: 100%; 
    max-width: 500px;
  }
  canvas {
    background: white;
    border: 1px solid #ccc;
    border-radius: 4px;
    width: 100%;
    height: auto;
    display: block;
  }
  .control-group { margin-bottom: 15px; }
  .control-group label { display: block; font-weight: bold; font-size: 0.9rem; margin-bottom: 5px; }
  .control-group input { width: 100%; }
  
  .btn-restart {
    width: 100%;
    padding: 10px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.2s;
  }
  .btn-restart:hover { background-color: #0056b3; }
  
  .stats-box {
    margin-top: 15px;
    padding: 10px;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-family: monospace;
    font-size: 0.9rem;
  }
</style>

<div class="gwo-container">
  <div class="gwo-controls">
    <div class="control-group">
      <label>Population Size: <span id="val-pop">30</span></label>
      <input type="range" id="popSize" min="5" max="100" value="30">
    </div>
    <div class="control-group">
      <label>Max Iterations: <span id="val-iter">500</span></label>
      <input type="range" id="maxIter" min="100" max="1000" step="10" value="500">
    </div>
    <div class="control-group">
      <label>Speed (FPS): <span id="val-speed">30</span></label>
      <input type="range" id="speed" min="1" max="60" value="30">
    </div>
    
    <button id="restartBtn" class="btn-restart">Restart Simulation</button>
    
    <div class="stats-box">
      <div>Best Fitness: <span id="bestScore" style="color:red; font-weight:bold;">Infinity</span></div>
      <div>Iteration: <span id="currentIter">0</span></div>
    </div>
    
    <div style="margin-top:15px; font-size:0.85rem; color:#666;">
      <strong>Legend:</strong><br>
      <span style="color:red">●</span> Alpha (1st)<br>
      <span style="color:orange">●</span> Beta (2nd)<br>
      <span style="color:gold">●</span> Delta (3rd)<br>
      <span style="color:grey">●</span> Omega (Pack)
    </div>
  </div>

  <div class="gwo-canvas">
    <canvas id="simCanvas" width="500" height="500"></canvas>
  </div>
</div>

<script>
(function() {
  const canvas = document.getElementById('simCanvas');
  const ctx = canvas.getContext('2d');
  
  // State
  let wolves = [];
  let alpha = { score: Infinity, x: 0, y: 0 };
  let beta = { score: Infinity, x: 0, y: 0 };
  let delta = { score: Infinity, x: 0, y: 0 };
  let iter = 0;
  let animId;
  
  // Config
  const bounds = 5.12; // Rastrigin bounds
  let params = { pop: 30, maxIter: 500, fps: 30 };
  
  // UI Refs
  const ui = {
    pop: document.getElementById('popSize'),
    iter: document.getElementById('maxIter'),
    speed: document.getElementById('speed'),
    restart: document.getElementById('restartBtn'),
    vPop: document.getElementById('val-pop'),
    vIter: document.getElementById('val-iter'),
    vSpeed: document.getElementById('val-speed'),
    score: document.getElementById('bestScore'),
    cIter: document.getElementById('currentIter')
  };

  // Rastrigin Function
  function fitness(x, y) {
    const A = 10;
    return A * 2 + (x * x - A * Math.cos(2 * Math.PI * x)) + (y * y - A * Math.cos(2 * Math.PI * y));
  }

  // Coord Mapping
  function toCanvas(x, y) {
    const nx = (x + bounds) / (2 * bounds);
    const ny = (y + bounds) / (2 * bounds);
    return {
      x: nx * canvas.width,
      y: canvas.height - (ny * canvas.height) // Flip Y
    };
  }

  function init() {
    wolves = [];
    for(let i=0; i<params.pop; i++) {
      wolves.push({
        x: (Math.random() * 2 * bounds) - bounds,
        y: (Math.random() * 2 * bounds) - bounds,
        score: Infinity
      });
    }
    alpha = { score: Infinity };
    beta = { score: Infinity };
    delta = { score: Infinity };
    iter = 0;
  }

  function update() {
    // 1. Evaluate
    for(let w of wolves) {
      // Clamp
      w.x = Math.max(-bounds, Math.min(bounds, w.x));
      w.y = Math.max(-bounds, Math.min(bounds, w.y));
      
      const f = fitness(w.x, w.y);
      w.score = f;
      
      if(f < alpha.score) {
        alpha = {...w};
      } else if(f < beta.score) {
        beta = {...w};
      } else if(f < delta.score) {
        delta = {...w};
      }
    }
    
    ui.score.innerText = alpha.score.toFixed(5);
    ui.cIter.innerText = iter + " / " + params.maxIter;

    // 2. Move (Standard GWO Math)
    const a = 2 - iter * (2 / params.maxIter);
    
    for(let w of wolves) {
      function solveDim(current, lA, lB, lD) {
        const calc = (leader) => {
          const r1 = Math.random(), r2 = Math.random();
          const A = 2 * a * r1 - a;
          const C = 2 * r2;
          const D = Math.abs(C * leader - current);
          return leader - A * D;
        };
        return (calc(lA) + calc(lB) + calc(lD)) / 3;
      }
      
      w.x = solveDim(w.x, alpha.x, beta.x, delta.x);
      w.y = solveDim(w.y, alpha.y, beta.y, delta.y);
    }
    
    iter++;
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Grid/Center
    const center = toCanvas(0,0);
    ctx.strokeStyle = "#eee";
    ctx.beginPath(); ctx.moveTo(center.x, 0); ctx.lineTo(center.x, canvas.height); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(0, center.y); ctx.lineTo(canvas.width, center.y); ctx.stroke();

    // Wolves
    for(let w of wolves) {
      const p = toCanvas(w.x, w.y);
      ctx.beginPath(); ctx.arc(p.x, p.y, 3, 0, 2*Math.PI);
      ctx.fillStyle = "rgba(100,100,100,0.5)"; ctx.fill();
    }
    
    // Leaders
    const drawL = (w, c, s) => {
      if(w.score === Infinity) return;
      const p = toCanvas(w.x, w.y);
      ctx.beginPath(); ctx.arc(p.x, p.y, s, 0, 2*Math.PI);
      ctx.fillStyle = c; ctx.fill();
      ctx.strokeStyle = "#333"; ctx.lineWidth=1; ctx.stroke();
    };
    
    drawL(delta, "gold", 5);
    drawL(beta, "orange", 6);
    drawL(alpha, "red", 8);
  }

  function loop() {
    setTimeout(() => {
      if(iter < params.maxIter) {
        update();
        draw();
      }
      animId = requestAnimationFrame(loop);
    }, 1000 / params.fps);
  }

  // Listeners
  ui.pop.oninput = (e) => { params.pop = +e.target.value; ui.vPop.innerText = params.pop; };
  ui.iter.oninput = (e) => { params.maxIter = +e.target.value; ui.vIter.innerText = params.maxIter; };
  ui.speed.oninput = (e) => { params.fps = +e.target.value; ui.vSpeed.innerText = params.fps; };
  ui.restart.onclick = () => {
    cancelAnimationFrame(animId);
    init();
    loop();
  };

  // Start
  init();
  loop();
})();
</script>